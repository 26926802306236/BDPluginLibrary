<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: modules/pluginsettings.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: modules/pluginsettings.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * An object that makes generating settings panel 10x easier.
 * @module PluginSettings
 * @version 1.0.5
 */

import {DiscordClasses} from "./DiscordClassModules";
import {$, jQuery} from "../vendor";
import {SettingField} from "../structs/settings/settingfield";

export const css = require("../styles/settings.css");

/**
 * The setting field.
 */
export {SettingField};

/** Attempts to retreive the accent color of native settings items in rgba format. */
const getAccentColor = function() {
	var bg = $('&lt;div class="ui-switch-item">&lt;div class="ui-switch-wrapper">&lt;input type="checkbox" checked="checked" class="ui-switch-checkbox">&lt;div class="ui-switch checked">');
	bg.appendTo($("#bd-settingspane-container"));
	var bgColor = $(".ui-switch.checked").first().css("background-color");
	var afterColor = window.getComputedStyle(bg.find(".ui-switch.checked")[0], ':after').getPropertyValue('background-color'); // For beardy's theme
	bgColor = afterColor == "rgba(0, 0, 0, 0)" ? bgColor : afterColor;
	bg.remove();
	return bgColor;
};

const createInputContainer = function(...children) {
	return $('&lt;div class="plugin-setting-input-container">').append(...children);
};


/** 
 * Grouping of controls for easier management in settings panels.
 * @version 1.0.1
 */
export class ControlGroup {
    /**
     * 
     * @constructor
     * @param {string} groupName - title for the group of settings
     * @param {callback} callback - callback called on settings changed
     * @param {object} options - additional options for the group
     * @param {boolean} [options.collapsible=true] - determines if the group should be collapsible
     * @param {boolean} [options.shown=false] - determines if the group should be expanded by default
     */
	constructor(groupName, callback, options = {}) {
		const {collapsible = true, shown = false} = options;
		this.group = $("&lt;div>").addClass("plugin-control-group").css("margin-top", "15px");
		var collapsed = shown || !collapsible ? '' : ' collapsed';
		var label = $('&lt;h2>').html('&lt;span class="button-collapse' + collapsed + '" style="">&lt;/span> ' + groupName);
		label.attr("class", `${DiscordClasses.SettingsMetaClasses.h5} ${DiscordClasses.SettingsMetaClasses.defaultMarginh5}`);
		this.group.append(label);
		this.controls = $('&lt;div class="plugin-controls collapsible' + collapsed + '">');
		this.group.append(this.controls);
		if (collapsible) {
			label.on('click', (e) => {
				let button = $(e.target).find('.button-collapse');
				let wasCollapsed = button.hasClass('collapsed');
				this.group.parent().find('.collapsible:not(.collapsed)').slideUp({duration: 300, easing: "easeInSine", complete: function() { $(this).addClass('collapsed'); }}); // .slideUp({duration: 300, easing: "easeInSine"})
				this.group.parent().find('.button-collapse').addClass('collapsed');
				if (wasCollapsed) {
					this.controls.slideDown({duration: 300, easing: "easeInSine"});
					this.controls.removeClass('collapsed');
					button.removeClass('collapsed');
				}
			});
		}
		
		if (typeof callback != 'undefined') {
			this.controls.on("change", "input", callback);
		}
	}
    
    /** @returns {jQuery} jQuery node for the group. */
	getElement() {return this.group;}
    
    /**
     * 
     * @param {(...HTMLElement|...jQuery)} nodes - list of nodes to add to the group container 
     * @returns {ControlGroup} returns self for chaining
     */
	append(...nodes) {
		for (var i = 0; i &lt; nodes.length; i++) {
			if (nodes[i] instanceof jQuery || nodes[i] instanceof Element) this.controls.append(nodes[i]);
			else if (nodes[i] instanceof PluginSettings.SettingField) this.controls.append(nodes[i].getElement());
		}
		return this;
	}
    
    /**
     * 
     * @param {(HTMLElement|jQuery)} node - node to attach the group to.
     * @returns {ControlGroup} returns self for chaining
     */
	appendTo(node) {
		this.group.appendTo(node);
		return this;
	}
}

/**
 * Callback for SettingField for change in input field.
 * @callback PluginSettings~settingsChanged
 * @param {*} value - new value of the input field
 */



/** 
 * Creates a simple textbox settings.
 * @version 1.0.0
 * @extends SettingField
 */
export class Textbox extends SettingField {
    /**
     * @constructor
     * @param {string} label - title for the setting
     * @param {string} help - description of the setting
     * @param {string} value - default value of the setting
     * @param {string} placeholder - placeholder text for when the textbox is empty
     * @param {PluginSettings~settingsChanged} callback - callback fired on textbox change
     * @param {object} options - additional options for the input field itself
     */
	constructor(label, help, value, placeholder, callback, options = {}) {
		options.type = "text";
		options.placeholder = placeholder;
		options.value = value;
		super(label, help, options, callback);
		this.input.addClass('plugin-input-text');
	}
}

/** 
 * Creates a color picker using chromium's built in color picker
 * as a base. Input and output using hex strings.
 * @version 1.0.0
 * @extends SettingField
 */
export class ColorPicker extends SettingField {
    /**
     * @constructor
     * @param {string} label - title for the setting
     * @param {string} help - description of the setting
     * @param {string} value - default value of the setting in hex format
     * @param {PluginSettings~settingsChanged} callback - callback fired on color change
     * @param {object} options - additional options for the input field itself
     */
	constructor(label, help, value, callback, options = {}) {
		options.type = "color";
		options.value = value;
		super(label, help, options, callback);
		this.input.css("margin-left", "10px");
		this.input.addClass('plugin-input-color');
		
		var settingLabel = $('&lt;span class="plugin-setting-label">').text(value);
		
		this.input.on("input", function() {
			settingLabel.text($(this).val());
		});
		
		this.setInputElement(createInputContainer(settingLabel, this.input));
	}
}

/** 
 * Creates a slider where the user can select a single number from a predefined range.
 * @version 1.0.0
 * @extends SettingField
 */
export class Slider extends SettingField {
    /**
     * @constructor
     * @param {string} settingLabel - title for the setting
     * @param {string} help - description of the setting
     * @param {number} min - minimum value allowed
     * @param {number} max - maximum value allowed
     * @param {number} step - granularity between values
     * @param {number} value - default value of the setting
     * @param {PluginSettings~settingsChanged} callback - callback fired on slider release
     * @param {object} options - additional options for the input field itself
     */
	constructor(settingLabel, help, min, max, step, value, callback, options = {}) {
		options.type = "range";
		options.min = min;
		options.max = max;
		options.step = step;
		options.value = parseFloat(value);
		super(settingLabel, help, options, callback);
		this.value = parseFloat(value); this.min = min; this.max = max;
		
		this.getValue = () => { return parseFloat(this.input.val()); };
		
		this.accentColor = getAccentColor();
		this.setBackground();
		this.input.css("margin-left", "10px").css("float", "right");
		this.input.addClass('plugin-input-range');
		
		this.labelUnit = "";
		this.label = $('&lt;span class="plugin-setting-label">').text(this.value + this.labelUnit);
		
		this.input.on("input", () => {
			this.value = parseFloat(this.input.val());
			this.label.text(this.value + this.labelUnit);
			this.setBackground();
		});
		
		this.setInputElement(createInputContainer(this.label, this.input));
	}
	
	getPercent() { return ((this.value - this.min) / this.max) * 100; }

	setBackground() {
		var percent = this.getPercent();
		this.input.css('background', 'linear-gradient(to right, ' + this.accentColor + ', ' + this.accentColor + ' ' + percent + '%, #72767d ' + percent + '%)');
	}

    /**
     * Adds a unit to the value label
     * @param {string} unit - unit to add to the label (e.g. "%")
     */
	setLabelUnit(unit) {this.labelUnit = unit; this.label.text(this.value + this.labelUnit); return this;}
}

/** 
 * Creates a checkbox in the style of a standard Discord switch.
 * @version 1.0.0
 * @extends SettingField
 */
export class Switch extends SettingField {
    /**
     * @constructor
     * @param {string} label - title for the setting
     * @param {string} help - description of the setting
     * @param {boolean} isChecked - determines if the checkbox is checked by default
     * @param {PluginSettings~settingsChanged} callback - callback fired on change
     * @param {object} options - additional options for the input field itself
     */
	constructor(label, help, isChecked, callback, options = {}) {
		options.type = "checkbox";
		options.checked = isChecked;
		super(label, help, options, callback);
		this.getValue = () => { return this.input.prop("checked"); };
		this.input.addClass("ui-switch-checkbox");
		this.input.addClass('plugin-input-checkbox');

		this.input.on("change", function() {
			if ($(this).prop("checked")) switchDiv.addClass("checked");
			else switchDiv.removeClass("checked");
		});
		
		this.checkboxWrap = $('&lt;label class="ui-switch-wrapper ui-flex-child" style="flex:0 0 auto;">');
		this.checkboxWrap.append(this.input);
		var switchDiv = $('&lt;div class="ui-switch">');
		if (isChecked) switchDiv.addClass("checked");
		this.checkboxWrap.append(switchDiv);
		this.checkboxWrap.css("right", "0px");

		this.setInputElement(this.checkboxWrap);
	}
}

/** 
 * Creates a PillButton where the left and right side have their own label.
 * It is important to note that the checked property here follows the same
 * standard as a normal Discord switch. That is to say if the value is true
 * then right side was selected, if the value is false then the left side 
 * was selected.
 * @version 1.0.1
 * @extends Switch
 */
export class PillButton extends Switch {
    /**
     * @constructor
     * @param {string} label - title for the setting
     * @param {string} help - description of the setting
     * @param {string} leftLabel - label for the option on the left
     * @param {string} rightLabel - label for the option on the right
     * @param {boolean} isRightSelected - determines if the right side is selected. (true = right side, false = left side)
     * @param {PluginSettings~settingsChanged} callback - callback fired on switch change (true = right side, false = left side)
     * @param {object} options - additional options for the input field itself
     */
	constructor(label, help, leftLabel, rightLabel, isRightSelected, callback, options = {}) {
		super(label, help, isRightSelected, callback, options);
		
		this.checkboxWrap.css("margin","0 9px");
		this.input.addClass('plugin-input-pill');
		
		var labelLeft = $('&lt;span class="plugin-setting-label left">');
		labelLeft.text(leftLabel);
		var labelRight = $('&lt;span class="plugin-setting-label right">');
		labelRight.text(rightLabel);
		
		var accent = getAccentColor();
		
		if (isRightSelected) labelRight.css("color", accent);
		else labelLeft.css("color", accent);
		
		this.checkboxWrap.find('input').on("click", function() {
			var checked = $(this).prop("checked");
			if (checked) {
				labelRight.css("color", accent);
				labelLeft.css("color", "");
			}
			else {
				labelLeft.css("color", accent);
				labelRight.css("color", "");
			}
		});
		
		this.setInputElement(createInputContainer(labelLeft, this.checkboxWrap.detach(), labelRight));
	}
}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-ColorConverter.html">ColorConverter</a></li><li><a href="module-DiscordAPI.html">DiscordAPI</a></li><li><a href="module-DiscordClassModules.html">DiscordClassModules</a></li><li><a href="module-DiscordModules.html">DiscordModules</a></li><li><a href="module-DiscordPermissions.html">DiscordPermissions</a></li><li><a href="module-DOMHelpers.html">DOMHelpers</a></li><li><a href="module-Logger.html">Logger</a></li><li><a href="module-Patcher.html">Patcher</a></li><li><a href="module-PluginContextMenu.html">PluginContextMenu</a></li><li><a href="module-PluginSettings.html">PluginSettings</a></li><li><a href="module-PluginTooltip.html">PluginTooltip</a></li><li><a href="module-PluginUpdateUtilities.html">PluginUpdateUtilities</a></li><li><a href="module-PluginUtilities.html">PluginUtilities</a></li><li><a href="module-ReactTools.html">ReactTools</a></li><li><a href="module-Utilities.html">Utilities</a></li></ul><h3>Classes</h3><ul><li><a href="module-DOMHelpers.ClassName.html">ClassName</a></li><li><a href="module-DOMHelpers.Selector.html">Selector</a></li><li><a href="module-PluginContextMenu.ImageItem.html">ImageItem</a></li><li><a href="module-PluginContextMenu.ItemGroup.html">ItemGroup</a></li><li><a href="module-PluginContextMenu.Menu.html">Menu</a></li><li><a href="module-PluginContextMenu.MenuItem.html">MenuItem</a></li><li><a href="module-PluginContextMenu.SubMenuItem.html">SubMenuItem</a></li><li><a href="module-PluginContextMenu.TextItem.html">TextItem</a></li><li><a href="module-PluginContextMenu.ToggleItem.html">ToggleItem</a></li><li><a href="module-PluginSettings.ColorPicker.html">ColorPicker</a></li><li><a href="module-PluginSettings.ControlGroup.html">ControlGroup</a></li><li><a href="module-PluginSettings.PillButton.html">PillButton</a></li><li><a href="module-PluginSettings.Slider.html">Slider</a></li><li><a href="module-PluginSettings.Switch.html">Switch</a></li><li><a href="module-PluginSettings.Textbox.html">Textbox</a></li><li><a href="module-PluginTooltip.NativeTooltip.html">NativeTooltip</a></li><li><a href="module-PluginTooltip.PluginTooltip.html">PluginTooltip</a></li><li><a href="SettingField.html">SettingField</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Thu May 17 2018 20:40:32 GMT-0400 (Eastern Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
