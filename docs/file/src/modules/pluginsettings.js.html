<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../">
  <title data-ice="title">src/modules/pluginsettings.js | pluginlibrary</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<meta name="description" content="Zere&apos;s library for BetterDiscord plugins."><meta property="twitter:card" content="summary"><meta property="twitter:title" content="pluginlibrary"><meta property="twitter:description" content="Zere&apos;s library for BetterDiscord plugins."></head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#modules">modules</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/modules/colorconverter.js~ColorConverter.html">ColorConverter</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/modules/contextmenu.js~ImageItem.html">ImageItem</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/modules/contextmenu.js~ItemGroup.html">ItemGroup</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/modules/contextmenu.js~Menu.html">Menu</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/modules/contextmenu.js~MenuItem.html">MenuItem</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/modules/contextmenu.js~SubMenuItem.html">SubMenuItem</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/modules/contextmenu.js~TextItem.html">TextItem</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/modules/contextmenu.js~ToggleItem.html">ToggleItem</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/modules/discordapi.js~DiscordAPI.html">DiscordAPI</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/modules/domhelpers.js~ClassName.html">ClassName</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/modules/domhelpers.js~DOMHelpers.html">DOMHelpers</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/modules/domhelpers.js~Selector.html">Selector</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/modules/logger.js~Logger.html">Logger</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/modules/patcher.js~Patcher.html">Patcher</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/modules/permissions.js~DiscordPermissions.html">DiscordPermissions</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/modules/pluginsettings.js~ColorPicker.html">ColorPicker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/modules/pluginsettings.js~ControlGroup.html">ControlGroup</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/modules/pluginsettings.js~PillButton.html">PillButton</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/modules/pluginsettings.js~Slider.html">Slider</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/modules/pluginsettings.js~Switch.html">Switch</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/modules/pluginsettings.js~Textbox.html">Textbox</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/modules/reacttools.js~ReactTools.html">ReactTools</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/modules/tooltips.js~NativeTooltip.html">NativeTooltip</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/modules/tooltips.js~PluginTooltip.html">PluginTooltip</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/modules/utilities.js~Utilities.html">Utilities</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/modules/webpackmodules.js~Filters.html">Filters</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/modules/webpackmodules.js~WebpackModules.html">WebpackModules</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-DiscordClasses">DiscordClasses</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-DiscordSelectors">DiscordSelectors</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-PluginUpdateUtilities">PluginUpdateUtilities</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-PluginUtilities">PluginUtilities</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-LogTypes">LogTypes</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-css">css</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#structs-settings">structs/settings</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/structs/settings/setting.js~SettingField.html">SettingField</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#vendor">vendor</a><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-$">$</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-jQuery">jQuery</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/modules/pluginsettings.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">/**
 * An object that makes generating settings panel 10x easier.
 * @module PluginSettings
 * @version 1.0.5
 */

import {DiscordClasses} from &quot;./DiscordClassModules&quot;;
import {$, jQuery} from &quot;../vendor&quot;;
import {SettingField} from &quot;../structs/settings/settingfield&quot;;

export const css = require(&quot;../styles/settings.css&quot;);

/**
 * The setting field.
 */
export {SettingField};

/** Attempts to retreive the accent color of native settings items in rgba format. */
const getAccentColor = function() {
	var bg = $(&apos;&lt;div class=&quot;ui-switch-item&quot;&gt;&lt;div class=&quot;ui-switch-wrapper&quot;&gt;&lt;input type=&quot;checkbox&quot; checked=&quot;checked&quot; class=&quot;ui-switch-checkbox&quot;&gt;&lt;div class=&quot;ui-switch checked&quot;&gt;&apos;);
	bg.appendTo($(&quot;#bd-settingspane-container&quot;));
	var bgColor = $(&quot;.ui-switch.checked&quot;).first().css(&quot;background-color&quot;);
	var afterColor = window.getComputedStyle(bg.find(&quot;.ui-switch.checked&quot;)[0], &apos;:after&apos;).getPropertyValue(&apos;background-color&apos;); // For beardy&apos;s theme
	bgColor = afterColor == &quot;rgba(0, 0, 0, 0)&quot; ? bgColor : afterColor;
	bg.remove();
	return bgColor;
};

const createInputContainer = function(...children) {
	return $(&apos;&lt;div class=&quot;plugin-setting-input-container&quot;&gt;&apos;).append(...children);
};


/** 
 * Grouping of controls for easier management in settings panels.
 * @version 1.0.1
 */
export class ControlGroup {
    /**
     * 
     * @constructor
     * @param {string} groupName - title for the group of settings
     * @param {callback} callback - callback called on settings changed
     * @param {object} options - additional options for the group
     * @param {boolean} [options.collapsible=true] - determines if the group should be collapsible
     * @param {boolean} [options.shown=false] - determines if the group should be expanded by default
     */
	constructor(groupName, callback, options = {}) {
		const {collapsible = true, shown = false} = options;
		this.group = $(&quot;&lt;div&gt;&quot;).addClass(&quot;plugin-control-group&quot;).css(&quot;margin-top&quot;, &quot;15px&quot;);
		var collapsed = shown || !collapsible ? &apos;&apos; : &apos; collapsed&apos;;
		var label = $(&apos;&lt;h2&gt;&apos;).html(&apos;&lt;span class=&quot;button-collapse&apos; + collapsed + &apos;&quot; style=&quot;&quot;&gt;&lt;/span&gt; &apos; + groupName);
		label.attr(&quot;class&quot;, `${DiscordClasses.SettingsMetaClasses.h5} ${DiscordClasses.SettingsMetaClasses.defaultMarginh5}`);
		this.group.append(label);
		this.controls = $(&apos;&lt;div class=&quot;plugin-controls collapsible&apos; + collapsed + &apos;&quot;&gt;&apos;);
		this.group.append(this.controls);
		if (collapsible) {
			label.on(&apos;click&apos;, (e) =&gt; {
				let button = $(e.target).find(&apos;.button-collapse&apos;);
				let wasCollapsed = button.hasClass(&apos;collapsed&apos;);
				this.group.parent().find(&apos;.collapsible:not(.collapsed)&apos;).slideUp({duration: 300, easing: &quot;easeInSine&quot;, complete: function() { $(this).addClass(&apos;collapsed&apos;); }}); // .slideUp({duration: 300, easing: &quot;easeInSine&quot;})
				this.group.parent().find(&apos;.button-collapse&apos;).addClass(&apos;collapsed&apos;);
				if (wasCollapsed) {
					this.controls.slideDown({duration: 300, easing: &quot;easeInSine&quot;});
					this.controls.removeClass(&apos;collapsed&apos;);
					button.removeClass(&apos;collapsed&apos;);
				}
			});
		}
		
		if (typeof callback != &apos;undefined&apos;) {
			this.controls.on(&quot;change&quot;, &quot;input&quot;, callback);
		}
	}
    
    /** @returns {jQuery} jQuery node for the group. */
	getElement() {return this.group;}
    
    /**
     * 
     * @param {(...HTMLElement|...jQuery)} nodes - list of nodes to add to the group container 
     * @returns {ControlGroup} returns self for chaining
     */
	append(...nodes) {
		for (var i = 0; i &lt; nodes.length; i++) {
			if (nodes[i] instanceof jQuery || nodes[i] instanceof Element) this.controls.append(nodes[i]);
			else if (nodes[i] instanceof PluginSettings.SettingField) this.controls.append(nodes[i].getElement());
		}
		return this;
	}
    
    /**
     * 
     * @param {(HTMLElement|jQuery)} node - node to attach the group to.
     * @returns {ControlGroup} returns self for chaining
     */
	appendTo(node) {
		this.group.appendTo(node);
		return this;
	}
}

/**
 * Callback for SettingField for change in input field.
 * @callback PluginSettings~settingsChanged
 * @param {*} value - new value of the input field
 */



/** 
 * Creates a simple textbox settings.
 * @version 1.0.0
 * @extends SettingField
 */
export class Textbox extends SettingField {
    /**
     * @constructor
     * @param {string} label - title for the setting
     * @param {string} help - description of the setting
     * @param {string} value - default value of the setting
     * @param {string} placeholder - placeholder text for when the textbox is empty
     * @param {PluginSettings~settingsChanged} callback - callback fired on textbox change
     * @param {object} options - additional options for the input field itself
     */
	constructor(label, help, value, placeholder, callback, options = {}) {
		options.type = &quot;text&quot;;
		options.placeholder = placeholder;
		options.value = value;
		super(label, help, options, callback);
		this.input.addClass(&apos;plugin-input-text&apos;);
	}
}

/** 
 * Creates a color picker using chromium&apos;s built in color picker
 * as a base. Input and output using hex strings.
 * @version 1.0.0
 * @extends SettingField
 */
export class ColorPicker extends SettingField {
    /**
     * @constructor
     * @param {string} label - title for the setting
     * @param {string} help - description of the setting
     * @param {string} value - default value of the setting in hex format
     * @param {PluginSettings~settingsChanged} callback - callback fired on color change
     * @param {object} options - additional options for the input field itself
     */
	constructor(label, help, value, callback, options = {}) {
		options.type = &quot;color&quot;;
		options.value = value;
		super(label, help, options, callback);
		this.input.css(&quot;margin-left&quot;, &quot;10px&quot;);
		this.input.addClass(&apos;plugin-input-color&apos;);
		
		var settingLabel = $(&apos;&lt;span class=&quot;plugin-setting-label&quot;&gt;&apos;).text(value);
		
		this.input.on(&quot;input&quot;, function() {
			settingLabel.text($(this).val());
		});
		
		this.setInputElement(createInputContainer(settingLabel, this.input));
	}
}

/** 
 * Creates a slider where the user can select a single number from a predefined range.
 * @version 1.0.0
 * @extends SettingField
 */
export class Slider extends SettingField {
    /**
     * @constructor
     * @param {string} settingLabel - title for the setting
     * @param {string} help - description of the setting
     * @param {number} min - minimum value allowed
     * @param {number} max - maximum value allowed
     * @param {number} step - granularity between values
     * @param {number} value - default value of the setting
     * @param {PluginSettings~settingsChanged} callback - callback fired on slider release
     * @param {object} options - additional options for the input field itself
     */
	constructor(settingLabel, help, min, max, step, value, callback, options = {}) {
		options.type = &quot;range&quot;;
		options.min = min;
		options.max = max;
		options.step = step;
		options.value = parseFloat(value);
		super(settingLabel, help, options, callback);
		this.value = parseFloat(value); this.min = min; this.max = max;
		
		this.getValue = () =&gt; { return parseFloat(this.input.val()); };
		
		this.accentColor = getAccentColor();
		this.setBackground();
		this.input.css(&quot;margin-left&quot;, &quot;10px&quot;).css(&quot;float&quot;, &quot;right&quot;);
		this.input.addClass(&apos;plugin-input-range&apos;);
		
		this.labelUnit = &quot;&quot;;
		this.label = $(&apos;&lt;span class=&quot;plugin-setting-label&quot;&gt;&apos;).text(this.value + this.labelUnit);
		
		this.input.on(&quot;input&quot;, () =&gt; {
			this.value = parseFloat(this.input.val());
			this.label.text(this.value + this.labelUnit);
			this.setBackground();
		});
		
		this.setInputElement(createInputContainer(this.label, this.input));
	}
	
	getPercent() { return ((this.value - this.min) / this.max) * 100; }

	setBackground() {
		var percent = this.getPercent();
		this.input.css(&apos;background&apos;, &apos;linear-gradient(to right, &apos; + this.accentColor + &apos;, &apos; + this.accentColor + &apos; &apos; + percent + &apos;%, #72767d &apos; + percent + &apos;%)&apos;);
	}

    /**
     * Adds a unit to the value label
     * @param {string} unit - unit to add to the label (e.g. &quot;%&quot;)
     */
	setLabelUnit(unit) {this.labelUnit = unit; this.label.text(this.value + this.labelUnit); return this;}
}

/** 
 * Creates a checkbox in the style of a standard Discord switch.
 * @version 1.0.0
 * @extends SettingField
 */
export class Switch extends SettingField {
    /**
     * @constructor
     * @param {string} label - title for the setting
     * @param {string} help - description of the setting
     * @param {boolean} isChecked - determines if the checkbox is checked by default
     * @param {PluginSettings~settingsChanged} callback - callback fired on change
     * @param {object} options - additional options for the input field itself
     */
	constructor(label, help, isChecked, callback, options = {}) {
		options.type = &quot;checkbox&quot;;
		options.checked = isChecked;
		super(label, help, options, callback);
		this.getValue = () =&gt; { return this.input.prop(&quot;checked&quot;); };
		this.input.addClass(&quot;ui-switch-checkbox&quot;);
		this.input.addClass(&apos;plugin-input-checkbox&apos;);

		this.input.on(&quot;change&quot;, function() {
			if ($(this).prop(&quot;checked&quot;)) switchDiv.addClass(&quot;checked&quot;);
			else switchDiv.removeClass(&quot;checked&quot;);
		});
		
		this.checkboxWrap = $(&apos;&lt;label class=&quot;ui-switch-wrapper ui-flex-child&quot; style=&quot;flex:0 0 auto;&quot;&gt;&apos;);
		this.checkboxWrap.append(this.input);
		var switchDiv = $(&apos;&lt;div class=&quot;ui-switch&quot;&gt;&apos;);
		if (isChecked) switchDiv.addClass(&quot;checked&quot;);
		this.checkboxWrap.append(switchDiv);
		this.checkboxWrap.css(&quot;right&quot;, &quot;0px&quot;);

		this.setInputElement(this.checkboxWrap);
	}
}

/** 
 * Creates a PillButton where the left and right side have their own label.
 * It is important to note that the checked property here follows the same
 * standard as a normal Discord switch. That is to say if the value is true
 * then right side was selected, if the value is false then the left side 
 * was selected.
 * @version 1.0.1
 * @extends Switch
 */
export class PillButton extends Switch {
    /**
     * @constructor
     * @param {string} label - title for the setting
     * @param {string} help - description of the setting
     * @param {string} leftLabel - label for the option on the left
     * @param {string} rightLabel - label for the option on the right
     * @param {boolean} isRightSelected - determines if the right side is selected. (true = right side, false = left side)
     * @param {PluginSettings~settingsChanged} callback - callback fired on switch change (true = right side, false = left side)
     * @param {object} options - additional options for the input field itself
     */
	constructor(label, help, leftLabel, rightLabel, isRightSelected, callback, options = {}) {
		super(label, help, isRightSelected, callback, options);
		
		this.checkboxWrap.css(&quot;margin&quot;,&quot;0 9px&quot;);
		this.input.addClass(&apos;plugin-input-pill&apos;);
		
		var labelLeft = $(&apos;&lt;span class=&quot;plugin-setting-label left&quot;&gt;&apos;);
		labelLeft.text(leftLabel);
		var labelRight = $(&apos;&lt;span class=&quot;plugin-setting-label right&quot;&gt;&apos;);
		labelRight.text(rightLabel);
		
		var accent = getAccentColor();
		
		if (isRightSelected) labelRight.css(&quot;color&quot;, accent);
		else labelLeft.css(&quot;color&quot;, accent);
		
		this.checkboxWrap.find(&apos;input&apos;).on(&quot;click&quot;, function() {
			var checked = $(this).prop(&quot;checked&quot;);
			if (checked) {
				labelRight.css(&quot;color&quot;, accent);
				labelLeft.css(&quot;color&quot;, &quot;&quot;);
			}
			else {
				labelLeft.css(&quot;color&quot;, accent);
				labelRight.css(&quot;color&quot;, &quot;&quot;);
			}
		});
		
		this.setInputElement(createInputContainer(labelLeft, this.checkboxWrap.detach(), labelRight));
	}
}</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
